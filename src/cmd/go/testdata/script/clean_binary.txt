# Build something to create the executable, including several cases

# --------------------- clean executables -------------------------

# case1: test file-named executable 'main'
env GO111MODULE=on

! exists main
go build main.go
exists -exec main
go clean
! exists main

# case2: test module-named executable 'a.b.c'
! exists a.b.c
go build
exists -exec a.b.c
go clean
! exists a.b.c

# case3: directory-named executable 'src'
env GO111MODULE=off

! exists src
go build
exists -exec src
go clean
! exists src

# --------------------- clean test files -------------------------

# case1: test file-named test file
env GO111MODULE=on

! exists main.test
go test -c main_test.go
exists -exec main.test
go clean
! exists main.test

# case2: test module-named test file
! exists a.b.c.test
go test -c
exists -exec a.b.c.test
go clean
! exists a.b.c.test

# case3: test directory-based test file
env GO111MODULE=off

! exists src.test
go test -c
exists -exec src.test
go clean
! exists src.test

-- main.go --
package main

import "fmt"

func main() {
	fmt.Println("hello!")
}

-- main_test.go --
package main

import "testing"

func TestSomething(t *testing.T) {
}

-- go.mod --
module example.com/a.b.c/v2

go 1.12